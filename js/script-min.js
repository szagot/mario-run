/**
 * By SzagOt 
 * Daniel Bispo <szagot@gmail.com>
 * 2022
 */
!function(e,t,s,o,i,r,a,l){const c=e.querySelector(".game-board"),n=e.querySelector(".mario"),p=e.querySelector(".pipe"),m=e.querySelector(".game-over"),y=e.querySelector(".btn"),u=e.querySelector(".start"),g=e.querySelector(".score"),d=e.querySelector(".max-score"),f=e.querySelector(".night");let L,v,h,b=0,S=!0,x=!1,I=!1,w=+(t.localStorage.getItem(o)||0),T=0,q=!1,C=!1,E=!1,M=!1,H=!1;const j=s("runing.mp3",!0),k=s("yoshi-music.mp3",!0),z=s("night.mp3",!0),$=s("game-over.mp3"),A=s("jump.mp3"),N=s("bowser-laugh.wav"),D=s("yoshi.wav"),B=s("yoshi-off.wav");s("boo-coin.mp3"),s("yoshi-coin.mp3"),s("coin2.mp3"),s("coin.mp3");const F=()=>{f.classList.remove("mario-show"),M=!1,j.pause(),z.pause(),k.pause(),E=!1,n.classList.remove("mario-show"),t.setTimeout((()=>{n.src="img/mario.gif",n.classList.remove("over"),n.classList.remove("game-over-mario"),n.style.bottom="0"}),300),p.src="img/pipe.png",p.style.left="auto",p.style.right="-100px",p.style.bottom="0",p.classList.remove("pipe-run"),p.classList.remove("bowser-run");e.querySelectorAll(".coin").forEach((e=>{c.removeChild(e)}));const s=e.querySelector(".egg");s&&c.removeChild(s),m.style.opacity="0",y.style.zIndex="998",y.style.opacity="0",u.style.zIndex="999",u.style.opacity="1",I=!1,x=!1,S=!0,b=0,g.innerHTML="0000",v&&t.clearInterval(v),h&&t.clearInterval(h),L&&clearInterval(L),Q()},G=()=>{v=t.setInterval((()=>{!x&&I&&(f.classList.add("mario-show"),M=!0,C?k.pause():j.pause(),z.play(),h=t.setInterval((()=>{!x&&I&&(f.classList.remove("mario-show"),M=!1,z.pause(),C?k.play():j.play(),G()),t.clearInterval(h)}),l),t.clearInterval(v))}),a)},J=()=>{q||(I||(I=!0,n.classList.add("mario-show"),p.classList.add("pipe-run"),u.style.opacity=0,j.play(),G()),S?!x&&I&&(q=!0,n.classList.add("jump"),A.play(),t.setTimeout((()=>{n.classList.remove("jump"),q=!1}),600)):F())},K=(e,t)=>{for(var s=e+"";s.length<t;)s="0"+s;return s},O=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),P=()=>{n.src=C?"img/mario.gif":"img/mario-yoshi.gif",C=!C,C?(M?z.pause():j.pause(),D.play(),k.play()):(k.pause(),B.play(),M?z.play():j.play())},Q=()=>{let a=O(10,100);L=t.setInterval((()=>{if(x||!I)return;g.innerHTML=K(b,4);let l=p.offsetLeft;const f=+t.getComputedStyle(n).bottom.replace("px","");if(l<120&&l>0&&f<100||H)if(C&&!H)P(),p.classList.remove("pipe-run"),p.style.left="-100px",l=-100,p.src="img/pipe.png",t.setTimeout((()=>{p.style.right="-100px",p.style.left="auto",t.setTimeout((()=>{p.classList.add("pipe-run")}),1e3)}),500);else{j.pause(),z.pause(),k.pause(),$.play(),p.classList.remove("pipe-run"),p.style.left=`${l}px`,n.classList.remove("jump"),n.style.bottom=`${f}px`,n.src="img/game-over.png",n.classList.add("over"),m.style.opacity="1";e.querySelectorAll(".coin").forEach((e=>{e.style.left=`${e.offsetLeft}px`,e.style.animation="none"}));const s=e.querySelector(".egg");s&&(s.style.left=`${s.offsetLeft}px`,s.style.animation="none"),b>w&&(w=b,t.localStorage.setItem(o,w),d.innerHTML=K(w,4)),t.setTimeout((()=>{n.classList.add("game-over-mario"),t.setTimeout((()=>{n.style.bottom="200px",t.setTimeout((()=>{n.style.bottom="-200px",t.setTimeout((()=>{y.style.opacity="1",y.style.zIndex="999",u.style.zIndex="998",S=!1}),300)}),300)}),300)}),500),x=!0,v&&t.clearInterval(v),h&&t.clearInterval(h),t.clearInterval(L)}if(T>=a&&!x&&I){a=O(10,M?300:80),T=0;const t=e.createElement("img");t.src="img/coin.png",t.classList.add("coin");const s=O(1,3)%2==0;t.style.bottom=s?"200px":"50px",s&&a>70&&!M&&(t.src="img/yoshi-coin.gif",t.classList.add("yoshi-coin")),M&&(t.src="img/boo.gif",t.classList.add("boo-coin")),c.appendChild(t)}T++;const q=e.querySelector(".coin");if(q){const e=q.offsetLeft,o=+t.getComputedStyle(q).bottom.replace("px",""),i=q.classList.contains("yoshi-coin"),r=q.classList.contains("boo-coin");if((e<=0||e<130&&o>f&&o<f+120)&&(c.removeChild(q),e>0)){let e=o>50;s(r?"boo-coin.mp3":i?"yoshi-coin.mp3":e?"coin2.mp3":"coin.mp3").play(),r?(b--,b<=0?H=!0:C&&P()):(b+=i?5:e?2:1,C&&(b+=i?5:e?2:1))}}let A=e.querySelector(".egg");if(!M&&!A&&!C&&b>0&&(b%i==0||(b+1)%i==0)){const t=e.createElement("img");t.src="img/egg-yoshi.gif",t.classList.add("egg"),c.appendChild(t)}if(A=e.querySelector(".egg"),A){const e=A.offsetLeft,s=+t.getComputedStyle(A).bottom.replace("px","");(e<=0||e<130&&s>f&&s<f+120)&&(c.removeChild(A),e>0&&P())}(b%r==0||(b+1)%r==0)&&b>10&&p.offsetLeft<=-80&&(M||E||(E=!0,N.play(),p.src="img/bowser.gif",p.classList.remove("pipe-run"),p.style.right="-100px",p.style.bottom="10px",t.setTimeout((()=>{p.classList.add("bowser-run"),t.setTimeout((()=>{x||(p.src="img/pipe.png",p.classList.remove("bowser-run"),p.style.right="-100px",p.style.bottom="0px",t.setTimeout((()=>{E=!1,p.classList.add("pipe-run")}),1200))}),1e3)}),1e3)))}),10)};e.addEventListener("keydown",J),c.addEventListener("touchstart",J),d.innerHTML=K(w,4),d.addEventListener("click",(()=>{if(S&&I)return!1;b=0,w=0,t.localStorage.setItem(o,w),g.innerHTML="0000",d.innerHTML="0000",F()})),y.addEventListener("click",F),u.addEventListener("click",J),Q()}(document,window,prepareAudio,gameName,yoshiScore,bowserScore,turnNight,turnDay);